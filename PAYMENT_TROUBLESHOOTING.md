# üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Telegram Payments

## –ü—Ä–æ–±–ª–µ–º–∞: –ü–ª–∞—Ç–µ–∂ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –Ω–∞ "Processing payment..."

### –°–∏–º–ø—Ç–æ–º—ã:
- –ü–æ–ø—ã—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Telegram Wallet
- –ü–æ—è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ kipish.fun"
- –ü–ª–∞—Ç–µ–∂ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Bot Token

1. –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: `/mybots`
3. –í—ã–±–µ—Ä–∏—Ç–µ: **–ê–ò —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏—è!**
4. –ù–∞–∂–º–∏—Ç–µ: **API Token**
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

**–§–æ—Ä–º–∞—Ç:** `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Provider Token –≤ BotFather

1. –í @BotFather –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
2. –ù–∞–∂–º–∏—Ç–µ: **Payments**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∫–∞–∫–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ —Ç–∞–º —É–∫–∞–∑–∞–Ω–æ:
- ‚úÖ **"Ammer Pay"** –∏–ª–∏ **"Custom"** - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚ùå **"Telegram Stars"** –∏–ª–∏ **"Wallet Pay"** - —ç—Ç–æ –¥—Ä—É–≥–∞—è —Å–∏—Å—Ç–µ–º–∞!

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Supabase

1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://supabase.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. **Settings** ‚Üí **Edge Functions** ‚Üí **Secrets**

–£ –≤–∞—Å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:
```
TELEGRAM_BOT_TOKEN=–≤–∞—à_bot_token
TELEGRAM_PROVIDER_TOKEN_TEST=6073714100:TEST:TG_0Hu7mBvcM_aynsU1VNlN9r8A
TELEGRAM_PROVIDER_TOKEN_LIVE=5775769170:LIVE:TG_W86WACpRtP4FJUebpZTbzm8A
```

---

## üöÄ –†–µ—à–µ–Ω–∏–µ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Ammer Pay

### 1.1. –û—Ç–≤—è–∑–∞—Ç—å —Å—Ç–∞—Ä—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –≤ BotFather –ø–æ–¥–∫–ª—é—á–µ–Ω –Ω–µ Ammer Pay:

1. @BotFather ‚Üí `/mybots`
2. –í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞
3. **Payments** ‚Üí **Remove provider**

### 1.2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å Ammer Pay –∑–∞–Ω–æ–≤–æ

1. @BotFather ‚Üí `/mybots`
2. –í—ã–±–µ—Ä–∏—Ç–µ: **–ê–ò —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏—è!**
3. –ù–∞–∂–º–∏—Ç–µ: **Payments**
4. –í—ã–±–µ—Ä–∏—Ç–µ: **Custom** (–∏–ª–∏ –Ω–∞–π–¥–∏—Ç–µ Ammer Pay –≤ —Å–ø–∏—Å–∫–µ)
5. –í—Å—Ç–∞–≤—å—Ç–µ **TEST Provider Token**: `6073714100:TEST:TG_0Hu7mBvcM_aynsU1VNlN9r8A`

‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

---

## üöÄ –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### 2.1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥

–í `create-telegram-invoice` –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `createInvoiceLink`, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è Ammer Pay.

**–ù–ï –ø—Ä–∞–≤–∏–ª—å–Ω–æ:** `sendInvoice` (–¥–ª—è –ø—Ä—è–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)

### 2.2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–∑–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```javascript
// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
tg.openInvoice(invoice_url, callback)

// –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
tg.openLink(invoice_url)
```

---

## üöÄ –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥

–ï—Å–ª–∏ Ammer Pay –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Telegram Stars**.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Stars:
- ‚úÖ –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ Telegram
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –æ–ø–ª–∞—Ç–∞

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–ª–∞—Ç—è—Ç –≤ Stars, –∞ –Ω–µ –≤ –≥—Ä–∏–≤–Ω–∞—Ö
- ‚ùå –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Stars ‚Üí UAH

**–•–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Stars?** –î–∞–π—Ç–µ –∑–Ω–∞—Ç—å, —è –æ–±–Ω–æ–≤–ª—é –∫–æ–¥.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

### –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Edge Functions Logs

1. Supabase Dashboard ‚Üí **Edge Functions**
2. –í—ã–±–µ—Ä–∏—Ç–µ: **create-telegram-invoice**
3. –ù–∞–∂–º–∏—Ç–µ: **Logs**

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- ‚úÖ "Telegram API response: { ok: true }" - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ùå "Error: Bad Request: invalid provider token" - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
- ‚ùå "Credentials missing" - –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

---

## ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ –ø–æ—Ä—è–¥–∫—É:

### ‚òëÔ∏è Checklist:

- [ ] Bot Token –ø–æ–ª—É—á–µ–Ω –∏–∑ @BotFather
- [ ] Provider Token –¥–æ–±–∞–≤–ª–µ–Ω –≤ @BotFather ‚Üí Payments
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Supabase
- [ ] Edge Function –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞ (`supabase functions deploy create-telegram-invoice`)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ—Ç –æ—à–∏–±–æ–∫ 401/403

---

## üí° –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤:

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Telegram
2. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ: @ai_stud_ai_bot
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –º–µ–Ω—é –≤–Ω–∏–∑—É
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫—É–ø–∏—Ç—å –ø–∞–∫–µ—Ç

**–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –°–∫–∏–Ω—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –ª–æ–≥–æ–≤ –∏–∑ Supabase
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
- –î–∞–π—Ç–µ –∑–Ω–∞—Ç—å, –∫–∞–∫–∞—è –æ—à–∏–±–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

---

## üÜò –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### "Invalid provider token"
‚ûú Provider Token –≤ Supabase –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –≤ @BotFather

### "Payment provider not set"
‚ûú –í @BotFather –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∫ –±–æ—Ç—É

### "Bad Gateway"
‚ûú Edge Function –Ω–µ –∑–∞–¥–µ–ø–ª–æ–µ–Ω–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

### "Authorize first"
‚ûú –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

–î–∞–≤–∞–π—Ç–µ –≤–º–µ—Å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –∏ –Ω–∞–π–¥—ë–º –ø—Ä–æ–±–ª–µ–º—É!
